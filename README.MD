# HoshimiSub

这是一个基于[HoshimiToolkit](https://github.com/MalitsPlus/HoshimiToolkit)的项目，在使用之前请确保您能正确运行该项目  
本项目的目标是能够通过HoshimiToolkit解析出的文件自动转换成字幕文件，减少轴man的工作量。

## 本次commit包含一些破坏性修改，pull过之后请务必阅读使用方法

## 重要提示

由于游戏剧情为即时演算画面，根据设备性能不同在切换场景时会有不同长度的载入时间，这种情况本项目**无法处理**，因此请在打轴时注意这一点。  
如果您使用Aegisub，可以通过`计时->平移时间`功能来调整字幕的时间，以适应游戏的载入时间。  

## 开发环境

Python 3.10  
Windows 11  

## 使用方法

首先，请`pip install -r requirements.txt`安装依赖,并确保在您的template文件夹中有`asstemp.ass`文件以及`Character.txt`文件。
在`asstemp.ass`文件中,将你的字幕样式添加到`[V4+ Styles]`区域，并确保Character.txt文件中的样式名与字幕文件中的样式名可以对应，如：

```
長瀬琴乃=长濑琴乃=KOTONO
伊吹渚=伊吹渚=NAGISA
白石沙季=白石沙季=SAKI
一同=一起=TOGETHE
...
```

该文件中的内容分为了三个段落，其含义为```脚本文件中的原始name字段值=中文译名=ASS字幕中的样式名称```，可以根据需要进行添加、修改、删除。
如果`Character`文件中没有对应内容将使用原始name字段值，样式将使用`IP_MESSAGE`样式。

打开命令行，在根目录下输入`python main.py -h`可以查看所有参数以及说明：

| 参数           | 必填  | 允许值           | 说明                                             |
|--------------|-----|---------------|------------------------------------------------|
| -p(--path)   | 是   | 文件或目录的相对或绝对路径 | 本参数指定源文件的位置，可以是文件的位置，也可以是文件夹                   |
| -o(--output) | 否   | 目录的相对或绝对路径    | 转换完成后的输出位置，不填写默认为程序根目录下的output文件夹，如不存在会自动生成该目录 |
| -t(--type)   | 否   | srt或ass       | 转换的目标格式，默认为srt                                 |
| -m(--mode)   | 是   | file或folder   | 工作方式为文件夹模式还是文件模式，默认为file                       |
| --name       | 否   |               | 如添加该参数，SRT字幕将会在每行字幕最前、ASS字幕将会另起一行，展示角色的姓名      |
| --style      | 否   |               | 如添加该参数，则表示每一位角色都使用其自己的样式，设置方法如前文所述             |

下面这条命令就是将source目录的脚本文件，以文件夹模式转换为ass字幕，并包含名字与每名角色的个人样式

```
python main.py -p ".\source" -t ass -m folder --name --style
```

## Feature & TODO List

- ✅能够生成SRT格式的字幕文件
- ✅批量处理功能
- ✅能够生成ASS格式字幕
- ✅支持命令行运行
- ✅生成时对原文角色名进行替换
- ✅支持根据角色自定字幕样式

## 写在最后

如果有任何功能建议或者bug，欢迎在issue中提出、直接PR或者PM我，Q群或者TG均可。  
**早坂芽衣可爱滴捏~**
